<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utef-8">
    <title>Web developing learing</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Last complied and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Popper js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>

    <!-- compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>

    <!-- mobile adjustement -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>
    <script>
        var sCloseiconbutton = "<button type=\"button\" class=\"close\" aria-label=\"Close\"><span aria-hidden=\"true\"> <span style=\"cursor:pointer\"> &times; </span></span></button>";
        function fSCloseicon(id){
            var text1 = "<button id=button";
            var text2 = " type=\"button\" class=\"close\" aria-label=\"Close\"><span aria-hidden=\"true\"> <span style=\"cursor:pointer\"> &times; </span></span></button>";
            return text1 + id + text2;
        }

        $(document).ready(function () {
            if (localStorage.getItem("idnumber") == null) {
                var idnumber = 0;
            }
            else var idnumber = localStorage.getItem("idnumber");

            //save the first localstorage for the finishedlist
            if (localStorage.getItem("finishedlist") == " ") {
                var aFinishtask = new Array;
            }
            else {
                aFinishtask = JSON.parse(localStorage.getItem("finishedlist"));
            }

            //output from the saved to do list
            if (JSON.parse(localStorage.getItem("todolist")) != null) {
                var printoutlist = JSON.parse(localStorage.getItem("todolist"))
                for (var i = 0; i < printoutlist.length; i++) {
                    var listID = printoutlist[i].taskid;
                    $("#to_do_list").append("<li class=\"list-group-item\" id=" + listID + ">" + "<span style=\"cursor:pointer\">" + printoutlist[i].taskname + sCloseiconbutton + "</span> </li>");
                }
            }

            //output from the finished 
            if (aFinishtask != null) {
                for (var i = 0; i < aFinishtask.length; i++) {
                    if (aFinishtask.length == 0) break;
                    $("#finish_tasks").append("<li class=\"list-group-item\">" + aFinishtask[i].slice(0, -4) + "</li>");
                }
            }
            else if (aFinishtask == null) {
                aFinishtask = new Array;
            }

            //todolistelement prototype
            function pTolistElement(id, name) {
                this.taskid = id;
                this.taskname = name;
            }

            $("#input_list").keypress(function (event) {
                if (event.which == 13 && $("#input_list").val()) {
                    var IDlistelement = "li" + idnumber;

                    $("#to_do_list").append("<li class=\"list-group-item\" id=" + IDlistelement + ">" + "<span style=\"cursor:pointer\">" + $("#input_list").val() + sCloseiconbutton + "</span>" + "</li>");
                    $("#" + IDlistelement).css('display', 'none');
                    $("#" + IDlistelement).slideDown(500, 'swing');

                    var Array_tasks;
                    if (JSON.parse(localStorage.getItem("todolist")) != null) Array_tasks = JSON.parse(localStorage.getItem("todolist"));
                    else Array_tasks = new Array;

                    Array_tasks.push(new pTolistElement(IDlistelement, $("#input_list").val()));
                    localStorage.setItem("todolist", JSON.stringify(Array_tasks));

                    $("#input_list").val("");

                    //test idnumber
                    console.log(idnumber);
                    idnumber++;
                    localStorage.setItem("idnumber", JSON.stringify(idnumber));
                }
            })

            $("#to_do_list").on("dblclick", "li", function (event) {
                event.preventDefault();
                //test for eventlistener and get the li id
                console.log($(this).attr("id"))
                var IDfinish = $(this).attr("id");

                //tests function
                console.log($(this).text());
                console.log(aFinishtask);

                aFinishtask.push($(this).text());
                $("#finish_tasks").append("<li class=\"list-group-item\">" + $(this).text().slice(0, -4) + "</li>");

                //delete localStorage delete
                var todo_list = JSON.parse(localStorage.getItem("todolist"));
                for (var i = 0; i < todo_list.length; i++) {
                    if (todo_list[i].taskid == IDfinish) {
                        console.log("id" + todo_list[i].taskid + " was removed");
                        todo_list.splice(i, 1);
                        $("#" + IDfinish).slideUp(500, 'linear', function () {
                            $("#" + IDfinish).remove();
                        });
                        break;
                    }
                }
                localStorage.setItem("todolist", JSON.stringify(todo_list));

                localStorage.setItem("finishedlist", JSON.stringify(aFinishtask));
            })

            $("#b_Add").click(function () {
                if ($("#input_list").val()) {
                    var IDlistelement = "li" + idnumber;
                    $("#to_do_list").append("<li class=\"list-group-item\" id=" + IDlistelement + ">" + "<span style=\"cursor:pointer\">" + $("#input_list").val() + sCloseiconbutton + "</span>" + "</li>");
                    $("#" + IDlistelement).css('display', 'none');
                    $("#" + IDlistelement).slideDown(500, 'swing');

                    //get the localStorage to do list
                    var todo_list = JSON.parse(localStorage.getItem("todolist"));
                    if (todo_list != null) {
                        todo_list.push(new pTolistElement(IDlistelement, $("#input_list").val()));
                    }
                    //save data to localStorage
                    localStorage.setItem("todolist", JSON.stringify(todo_list));
                    $("#input_list").val("");

                    //test idnumber
                    console.log(idnumber);
                    idnumber++;
                    localStorage.setItem("idnumber", JSON.stringify(idnumber));
                }
            })

            $("#bClear").click(function () {
                localStorage.clear();
                location.reload();
            })

            $("#button_finish").click(function () {
                localStorage.setItem("finishedlist", null);
                location.reload();
            })
        })
    </script>

    <style>
        .fade li {
            transition: all 0.4s ease-out;
            opacity: 0;
            height: 2em;
        }

        .fade li.show {
            opacity: 1;
        }
    </style>
    <!-- setup modal for edit the task name -->
    <div id="taskedit" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content -->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Edit To Do List Task</h4>
                </div>
                <div class="modal-body">
                    <input id="input_edittask" value="" type="input_text" placeholder="type the new task">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dimiss="modal"> Close </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Toggleable Dynamic Tabs -->
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#home"> Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#to_do_list_tab"> To do list</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#finish_list_tab">Finish list</a>
            </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div id="home" class="container tab-pane active">
                <br>
                <h3>HOME</h3>
                <p> The purpose of this website is designed for learning front-end developing skills.</p>
            </div>

            <!-- to do list -->
            <div id="to_do_list_tab" class="container tab-pane fade">
                <!-- add list and show to do list -->
                <br>
                <div class="card" styple="width=auto;">
                    <br>
                    <div class="card-block">
                        <h4 class="card-title"> &nbsp To do list
                            <font size="3"> &nbsp
                                <button id="bClear" size="5" type="button" class="btn btn-outline-primary">
                                    <span style="cursor:pointer">Clear List</span>
                                </button>
                            </font>
                        </h4>
                        <p class="card-text">
                            <div class="input-group" style="width:auto;">
                                <span class="input-group-btn" style="width:auto;">
                                    <button class="btn btn-outline-primary" type="button" id="b_Add">
                                        <span style="cursor:pointer"> Add tasks</span>
                                    </button>
                                </span>
                                <input id="input_list" value="" type="input_text" class="form-control" placeholder="e.g. homeworks" aria-label="e.g. homworks">
                                <!--  <input type="input_text_content" class="form-control" placeholder="tasks information"> -->
                            </div>
                        </p>
                    </div>
                    <br>

                    <div class="card" style="width:auto;">
                        <ul class="list-group list-group-flush" id="to_do_list">
                        </ul>
                    </div>

                </div>
            </div>

            <!-- finished list -->
            <div id="finish_list_tab" class="container tab-pane fade">
                <br>
                <div class="card" style="width:auto;">
                    <br>
                    <div class="card_block">
                        <h4 class="card-title"> &nbsp Finished Tasks Lists
                            <font size="3"> &nbsp
                                <button id="button_finish" size="5" type="button" class="btn btn-outline-primary">
                                        <span style="cursor:pointer">Clear Finished List</span>
                                </button>
                            </font>
                        </h4>
                    </div>

                    <ul class="list-group list-group-flush" id="finish_tasks"></ul>
                </div>
            </div>
        </div>

    </div>
</body>

</html>